<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<body>
	<script>
	// Syntax: new Set([iterable]) : Set
	// Set 无序集合
	const set = new Set();
	console.log(set);

	const setArr = new Set([1,2,3]);
	console.log(setArr);

	// 操作方法
	// set.add(value);  add value in set
	// set.delete(value);  delete value in set
	// set.clear();  clear set()
	// set.forEach(callbackFn[,context]);  loop every in set
	// set.has(value). check value in set() or not;

	const setAdd = new Set();
	setAdd.add(1).add(2).add(3).add(3)/*最后一句不起作用，因为3已存在集合里*/
	console.log(setAdd);

	const checkSet = new Set([1,2,3,4]);
	console.log(checkSet.has(2));// true
	console.log(checkSet.has(5));// false


	window.isfoo = { foo: 2 };
	const loopSet = new Set([1,2,3,4]);
	loopSet.forEach(item => {
		console.log(this.isfoo.foo * item)
	},isfoo);

	for ( const val of loopSet ) {
		console.log(val)
	};

	// WeakSet
	// Syntax: new WeakSet() : WeakSet
	const weakSet = new WeakSet();
	/*
	 * WeakSet.add(1)
	 * In Chrome
	 * Uncaught ReferenceError: WeakSet is not defined(…)
	 */
	weakSet.add({ foo: 1 });
	console.log(weakSet); // WeakSet {Object {foo: 1}}

	console.log(weakSet.size) // undefined
	/*
	 * WeakSet 与 Set 有三个不一样的地方
	 *
	 * WeakSet 不能包含值类型元素
	 * WeakSet 不能包含无引用元素
	 * WeakSet 无法被探知大小与其中包含的元素
	 *
	 */

	let istoo = { ba: 1 };
	weakSet.add(istoo);
	console.log(weakSet.has(istoo)); // true

	istoo = null;
	console.log(weakSet.has(istoo)); // false

	let str = new String('hello');
	weakSet.add(str);
	console.log(weakSet.has(str));// true

	str+=' World';
	console.log(weakSet.has(str));// false
	//被加入WeakSet中的字符串不能被修改，因为一旦进行修改，其引用便会丢失，甚至导致被移除出集合。

	//Map 映射类型
	//Syntax: new Map([iterable]) : Map
	const map = new Map();
	const mapA = new Map([['foo',1],['foo',2]]);
	console.log(mapA.get('foo')) // 2

	// 操作方法
	// map.set(key, value);  add key-value pair to map
	// map.get(key);  get key in map
	// map.delete(key);  remove key from map
	// map.clear();  clear all the key-value pairs from map
	// map.entries();  return a key-value pairs to be element's array
	// map.has(key);  cheak key in map or not
	// map.keys();  返回一个已当前映射中所有键做为元素的可迭送对象
	// map.value();  返回一个以当前映射中所有值作为元素的可迭送对象
	// map.size  映射中键值对的数量

	map.set('foo','Hello');
	map.set('bar','World');
	map.set('bar','Es2015');
	console.log(map);

	map.delete('foo');
	console.log(map);

	console.log(map.get('bar'));

	console.log(map.has('foo'));

	console.log(map.has('bar'));

	map.set('foo','Hello');

	console.log(Array.from(map.entries()));

	for(const [ key, value ] of map) {
		console.log(`${key}: ${value}`)
	};

	map.forEach((value, key, map) => {
		console.log(`${key}: ${value}`)
	});

	for(const [ key, value ] in map) {
		console.log(`${key}: ${value}`)
	};

	// Syntax: new WeakMap([iterable]) : WeakMap
	const weakm = new WeakMap();
	let keyObject = { id: 1 };
	const valObject = { score: 100 };

	weakm.set(keyObject, valObject);
	weakm.get(keyObject);
	keyObject = null;
	console.log(weakm.has(keyObject)); //false
	</script>
</body>
</html>
